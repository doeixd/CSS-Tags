---
// FormField.astro - Wrapper component for form fields with labels, help, and error text
interface Props {
  label?: string;
  helpText?: string;
  errorText?: string;
  required?: boolean;
  disabled?: boolean;
  class?: string;
  children: Astro.Component | string;
}

const {
  label,
  helpText,
  errorText,
  required = false,
  disabled = false,
  class: className,
  children,
  ...rest
} = Astro.props;
---

<div class={`form-field ${disabled ? 'form-field--disabled' : ''} ${className || ''}`} {...rest}>
  {label && (
    <label class="form-label" for={rest.id}>
      {label}
      {required && <span class="form-required" aria-label="required">*</span>}
    </label>
  )}

  <div class="form-field-input">
    {children}
  </div>

  {helpText && (
    <div class="form-help" id={rest.id ? `${rest.id}-help` : undefined}>
      {helpText}
    </div>
  )}

  {errorText && (
    <div class="form-error" id={rest.id ? `${rest.id}-error` : undefined} role="alert">
      {errorText}
    </div>
  )}
</div>

<style>
  .form-field {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
  }

  .form-field--disabled {
    opacity: 0.6;
    pointer-events: none;
  }

  .form-label {
    font-weight: var(--font-weight-medium);
    color: var(--text-primary);
    font-size: var(--form-label-font-size, var(--font-size-sm));
    display: flex;
    align-items: center;
  }

  .form-required {
    color: var(--form-required-color, #dc3545);
    margin-left: var(--space-xs);
    font-size: var(--font-size-sm);
  }

  .form-field-input {
    /* Container for the actual input/control */
  }

  .form-help {
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    line-height: var(--line-height-body);
  }

  .form-error {
    font-size: var(--font-size-sm);
    color: var(--form-error-color, #dc3545);
    line-height: var(--line-height-body);
  }

  /* Dark mode support */
  @media (prefers-color-scheme: dark) {
    :root:not(.light-mode) .form-field--disabled {
      opacity: 0.5;
    }
  }

  :root.dark-mode .form-field--disabled {
    opacity: 0.5;
  }

  /* Mobile responsive */
  @media (max-width: 768px) {
    .form-field {
      gap: var(--space-xs);
    }

    .form-label {
      font-size: var(--font-size-sm);
    }

    .form-help,
    .form-error {
      font-size: var(--font-size-xs);
    }
  }
</style>