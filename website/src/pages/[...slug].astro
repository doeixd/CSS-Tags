---
import { getCollection, render } from "astro:content";
import DocsLayout from "../layouts/DocsLayout.astro";
import Breadcrumbs from "../components/Breadcrumbs.astro";
import PageMeta from "../components/PageMeta.astro";
import PrevNextNav from "../components/PrevNextNav.astro";
import ScrollToTop from "../components/ScrollToTop.astro";

export async function getStaticPaths() {
    const docs = await getCollection("docs");

    return docs
        .filter((entry) => entry.id !== "index")
        .map((entry) => ({
            params: { slug: entry.id },
            props: { entry },
        }));
}

const { entry } = Astro.props;
const { Content, headings } = await render(entry);
const currentPath = entry.id;
---

<ScrollToTop containerSelector=".scroll-to-top-container" />
<DocsLayout
    title={entry.data.title}
    description={entry.data.description}
    currentPath={currentPath}
    headings={headings}
>
    <Breadcrumbs currentPath={currentPath} />
    <div class="scroll-to-top-container" style="position: relative">
        <h1>{entry.data.title}</h1>
        {
            entry.data.description && (
                <p class="description">{entry.data.description}</p>
            )
        }
        <Content />
    </div>
    <div
        style="position: relative; background-color: var(--bg-primary);"
    >
        <PageMeta currentPath={currentPath} />
        <PrevNextNav currentPath={currentPath} />
    </div>
</DocsLayout>
